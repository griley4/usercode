{

  float xsec_dp[5];
  float xsec_pt1[7];
  float xsec_pt2[6];
  float xsec_pta[5];
  float pop_dp[5];
  float pop_pt1[7];
  float pop_pt2[6];
  float pop_pta[5];
  float xsec_dp_err[5];
  float xsec_pt1_err[7];
  float xsec_pt2_err[6];
  float xsec_pta_err[5];
  float binfit_plus5_dp[5];
  float binfit_plus5_pt1[7];
  float binfit_plus5_pt2[6];
  float binfit_plus5_pta[5];

  float dpbins[]={0,0.25,1.0,1.75,2.5,3.142}; 
  float pt1bins[]={5,10,12,14,17,20,25,60};
  float pt2bins[]={5,8,10,12,15,20,40};
  float ptabins[]={0,0.05,0.125,0.2,0.35,1.};
  int ndpbins = 5;
  int npt1bins = 7;
  int npt2bins = 6;
  int nptabins = 5;

  //xsec_mass[0] = 47.3;        
  //xsec_mass[1] = 22.8;        
  //xsec_mass[2] = 10.5;        
  //xsec_mass[3] = 7.3;
  //xsec_mass[4] = 4.7;       
  //xsec_mass[5] = 2.7;       
  //xsec_mass[6] = 2.3;
  //xsec_mass[7] = 0.4;
  //xsec_mass_err[0] = 6.3;
  //xsec_mass_err[1] = 2.4;
  //xsec_mass_err[2] = 1.5;
  //xsec_mass_err[3] = 1.2;
  //xsec_mass_err[4] = 0.7;
  //xsec_mass_err[5] = 0.4;
  //xsec_mass_err[6] = 0.3;
  //xsec_mass_err[7] = 0.05;
  //xsec_pt[0] = 5.5;
  //xsec_pt[1] = 5.8;
  //xsec_pt[2] = 9.8;
  //xsec_pt[3] = 9.5;
  //xsec_pt[4] = 5.7;
  //xsec_pt[5] = 0.7;
  //xsec_pt[6] = 0.06;
  //xsec_pt_err[0] = 0.7;
  //xsec_pt_err[1] = 0.9;
  //xsec_pt_err[2] = 1.6;
  //xsec_pt_err[3] = 1.2;
  //xsec_pt_err[4] = 0.6;
  //xsec_pt_err[5] = 0.06;
  //xsec_pt_err[6] = 0.019;
  //xsec_dy[0] = 352.5;
  //xsec_dy[1] = 208.3;
  //xsec_dy[2] = 99.7;
  //xsec_dy[3] = 59.5;
  //xsec_dy[4] = 39.2;
  //xsec_dy[5] = 23.7;
  //xsec_dy[6] = 22.7;
  //xsec_dy[7] = 10.5;
  //xsec_dy_err[0] = 28.5;
  //xsec_dy_err[1] = 21.6;
  //xsec_dy_err[2] = 14.1;
  //xsec_dy_err[3] = 10.3;
  //xsec_dy_err[4] = 6.8;
  //xsec_dy_err[5] = 5.4;
  //xsec_dy_err[6] = 4.6;
  //xsec_dy_err[7] = 2.3;
  //std::cout<<"he3re"<<std::endl;
  //xsec_y[0] = 96.6;
  //xsec_y[1] = 110.2;
  //xsec_y[2] = 89.0;
  //xsec_y[3] = 101.5;
  //xsec_y[4] = 77.4;
  //xsec_y[5] = 95.5;
  //xsec_y[6] = 137.2;
  //xsec_y[7] = 167.9;
  //xsec_y[8] = 120.1;
  //xsec_y_err[0] = 14.9;
  //xsec_y_err[1] = 15.6;
  //xsec_y_err[2] = 12.4;
  //xsec_y_err[3] = 13.6;
  //xsec_y_err[4] = 10.9;
  //xsec_y_err[5] = 14.2;
  //xsec_y_err[6] = 17.4;
  //xsec_y_err[7] = 22.9;
  //xsec_y_err[8] = 22.7;
  xsec_dp[0] = 209.4656; 
  xsec_dp[1] = 69.02457;
  xsec_dp[2] = 34.69847;
  xsec_dp[3] = 20.12112;
  xsec_dp[4] = 48.60252;
  xsec_dp_err[0] = 17.91482;
  xsec_dp_err[1] = 6.363967;
  xsec_dp_err[2] = 4.785995;
  xsec_dp_err[3] = 3.611484;
  xsec_dp_err[4] = 5.282882;
  xsec_pt1[0] = 17.98249;
  xsec_pt1[1] = 20.29754;
  xsec_pt1[2] = 13.24415;
  xsec_pt1[3] = 5.774441;
  xsec_pt1[4] = 2.390215;
  xsec_pt1[5] = 1.380788;
  xsec_pt1[6] = 0.1380014;
  xsec_pt1_err[0] = 2.229437;
  xsec_pt1_err[1] = 2.242569;
  xsec_pt1_err[2] = 1.517559;
  xsec_pt1_err[3] = 0.6394296;
  xsec_pt1_err[4] = 0.3345421;
  xsec_pt1_err[5] = 0.2161233;
  xsec_pt1_err[6] = 0.0262028;
  xsec_pt2[0] = 36.13713;
  xsec_pt2[1] = 26.1461;
  xsec_pt2[2] = 10.42912;
  xsec_pt2[3] = 2.576978;
  xsec_pt2[4] = 0.4564093;
  xsec_pt2[5] = 0.07642577;
  xsec_pt2_err[0] = 3.680634;
  xsec_pt2_err[1] = 2.490104;
  xsec_pt2_err[2] = 1.017475;
  xsec_pt2_err[3] = 0.31154;
  xsec_pt2_err[4] = 0.07606822;
  xsec_pt2_err[5] = 0.02266866;
  xsec_pta[0] = 345.8567;
  xsec_pta[1] = 1079.745;
  xsec_pta[2] = 519.3201;
  xsec_pta[3] = 301.3317;
  xsec_pta[4] = 20.04797;
  xsec_pta_err[0] = 64.53302;
  xsec_pta_err[1] = 81.71044;
  xsec_pta_err[2] = 57.12521;
  xsec_pta_err[3] = 28.82303;
  xsec_pta_err[4] = 3.310673;

  pop_dp[0] = 152.;
  pop_dp[1] = 141.;
  pop_dp[2] = 58.;
  pop_dp[3] = 39.;
  pop_dp[4] = 92.;
  pop_pt1[0] = 73.4;
  pop_pt1[1] = 88.7;
  pop_pt1[2] = 96.;
  pop_pt1[3] = 88.5;
  pop_pt1[4] = 54.3;
  pop_pt1[5] = 46;
  pop_pt1[6] = 31.6;
  pop_pt2[0] = 108;
  pop_pt2[1] = 126;
  pop_pt2[2] = 123;
  pop_pt2[3] = 76.1;
  pop_pt2[4] = 36;
  pop_pt2[5] = 11.8;
  pop_pta[0] = 34.5;
  pop_pta[1] = 185;
  pop_pta[2] = 100;
  pop_pta[3] = 115;
  pop_pta[4] = 43.6;
  binfit_plus5_dp[0] = 210.9003;
  binfit_plus5_dp[1] = 69.71106;
  binfit_plus5_dp[2] = 35.13644;
  binfit_plus5_dp[3] = 20.35296;
  binfit_plus5_dp[4] = 48.0541;
  binfit_plus5_pt1[0] = 17.61216;
  binfit_plus5_pt1[1] = 20.28992;
  binfit_plus5_pt1[2] = 13.29124;
  binfit_plus5_pt1[3] = 5.871272;
  binfit_plus5_pt1[4] = 2.517846;
  binfit_plus5_pt1[5] = 1.545936;
  binfit_plus5_pt1[6] = 0.162582;
  binfit_plus5_pt2[0] = 33.18765;
  binfit_plus5_pt2[1] = 25.81485;
  binfit_plus5_pt2[2] = 10.26823;
  binfit_plus5_pt2[3] = 2.585684;
  binfit_plus5_pt2[4] = 0.4736536;
  binfit_plus5_pt2[5] = 0.07642577;
  binfit_plus5_pta[0] = 356.4886;
  binfit_plus5_pta[1] = 1112.457;
  binfit_plus5_pta[2] = 535.7559;
  binfit_plus5_pta[3] = 309.241;
  binfit_plus5_pta[4] = 20.47833;
  
  float tp_dp[5];
  float tp_pt1[7];
  float tp_pt2[6];
  float tp_pta[5];
  tp_dp[0] =  0.187299;
  tp_dp[1] =   0.211277;
  tp_dp[2] =   0.19255;
  tp_dp[3] =  0.213922;
  tp_dp[4] =  0.214664;
  tp_pt1[0] = 0.361584  ;
  tp_pt1[1] = 0.256302  ;
  tp_pt1[2] =  0.21533  ;
  tp_pt1[3] = 0.184563  ;
  tp_pt1[4] = 0.146478  ;
  tp_pt1[5] = 0.118045  ;
  tp_pt1[6] = 0.0938983 ;
  tp_pt2[0] =  0.313698;
  tp_pt2[1] =  0.238785 ;
  tp_pt2[2] =  0.190435 ;
  tp_pt2[3] =  0.131826 ;
  tp_pt2[4] =  0.0808294;
  tp_pt2[5] =  0.0811883;
  tp_pta[0] =   0.207995;
  tp_pta[1] =   0.213028;
  tp_pta[2] =   0.215356 ;
  tp_pta[3] =   0.195633;
  tp_pta[4] =   0.154274  ;

  float PerBinFixed = 0.01;
  float Bkg2P = 0.022;
  float SigCB = 0.01;
  float JAcc = 0.019;
  float unc_dp[5]; 
  float unc_pt1[7]; 
  float unc_pt12[7]; 
  float unc_pt2[6]; 
  float unc_pta[5]; 
  float tot_stat_dp;
  float tot_syst_dp;
  float tot_stat_pt1;
  float tot_syst_pt1;
  float tot_syst_pt12;
  float tot_stat_pt2;
  float tot_syst_pt2;
  float tot_stat_pta;
  float tot_syst_pta;
  float tot_dp=0;
  float tot_pt1;
  float tot_pt2;
  float tot_pta;
  float tot_dp_n=0;
  float tot_pt1_n;
  float tot_pt2_n;
  float tot_pta_n;
  float tot_tp_dp=0;
  float tot_tp_pt1;
  float tot_tp_pt2;
  float tot_tp_pta;
  float tot_bf_dp=0;
  float tot_bf_pt1;
  float tot_bf_pt2;
  float tot_bf_pta;
  
  TH1F* dp_tp = new TH1F("dp_tp","dp_tp", 5, dpbins); 
  TH1F* dp_bf = new TH1F("dp_bf","dp_bf", 5, dpbins); 
  TH1F* dp_acc = new TH1F("dp_acc","dp_acc", 5, dpbins); 
  TH1F* dp_cb = new TH1F("dp_cb","dp_cb", 5, dpbins); 
  TH1F* dp_bkg = new TH1F("dp_bkg","dp_bkg", 5, dpbins); 
  TH1F* dp_fixed = new TH1F("dp_fixed","dp_fixed", 5, dpbins); 
  TH1F* dp_stat = new TH1F("dp_stat","dp_stat", 5, dpbins);
  dp_stat->SetMinimum(-0.3);
  dp_stat->SetMaximum(0.3); 
  TH1F* pt1_tp = new TH1F("pt1_tp","pt1_tp", 7, pt1bins); 
  TH1F* pt1_bf = new TH1F("pt1_bf","pt1_bf", 7, pt1bins); 
  TH1F* pt1_acc = new TH1F("pt1_acc","pt1_acc", 7, pt1bins); 
  TH1F* pt1_cb = new TH1F("pt1_cb","pt1_cb", 7, pt1bins); 
  TH1F* pt1_bkg = new TH1F("pt1_bkg","pt1_bkg", 7, pt1bins); 
  TH1F* pt1_fixed = new TH1F("pt1_fixed","pt1_fixed", 7, pt1bins); 
  TH1F* pt1_stat = new TH1F("pt1_stat","pt1_stat", 7, pt1bins);
  pt1_stat->SetMinimum(-0.3);
  pt1_stat->SetMaximum(0.3); 
  TH1F* pt2_tp = new TH1F("pt2_tp","pt2_tp", 6, pt2bins); 
  TH1F* pt2_bf = new TH1F("pt2_bf","pt2_bf", 6, pt2bins); 
  TH1F* pt2_acc = new TH1F("pt2_acc","pt2_acc", 6, pt2bins); 
  TH1F* pt2_cb = new TH1F("pt2_cb","pt2_cb", 6, pt2bins); 
  TH1F* pt2_bkg = new TH1F("pt2_bkg","pt2_bkg", 6, pt2bins); 
  TH1F* pt2_fixed = new TH1F("pt2_fixed","pt2_fixed", 6, pt2bins); 
  TH1F* pt2_stat = new TH1F("pt2_stat","pt2_stat", 6, pt2bins);
  pt2_stat->SetMinimum(-0.3);
  pt2_stat->SetMaximum(0.3); 
  TH1F* pta_tp = new TH1F("pta_tp","pta_tp", 5, ptabins); 
  TH1F* pta_bf = new TH1F("pta_bf","pta_bf", 5, ptabins); 
  TH1F* pta_acc = new TH1F("pta_acc","pta_acc", 5, ptabins); 
  TH1F* pta_cb = new TH1F("pta_cb","pta_cb", 5, ptabins); 
  TH1F* pta_bkg = new TH1F("pta_bkg","pta_bkg", 5, ptabins); 
  TH1F* pta_fixed = new TH1F("pta_fixed","pta_fixed", 5, ptabins); 
  TH1F* pta_stat = new TH1F("pta_stat","pta_stat", 5, ptabins);
  pta_stat->SetMinimum(-0.3);
  pta_stat->SetMaximum(0.3); 

  std::cout<<"here"<<std::endl;
  for (int i=0; i<5;++i){
    unc_dp[i] = sqrt(pow(binfit_plus5_dp[i]-xsec_dp[i],2)+pow(PerBinFixed*xsec_dp[i],2)+pow(Bkg2P*xsec_dp[i],2)+pow(SigCB*xsec_dp[i],2)+pow(JAcc*xsec_dp[i],2)+pow(0.5*tp_dp[i]*xsec_dp[i],2));
    //std::cout<<"dPhi Bin: "<<i+1<<" Cross Section systematic: "<<xsec_dp[i]<<" +/- "<<xsec_dp_err[i]<<" +/- "<<unc_dp[i]<<" which is "<<xsec_dp_err[i]/xsec_dp[i]<<" & "<<unc_dp[i]/xsec_dp[i]<<" % relative unc"<<" and "<<sqrt(pow(xsec_dp_err[i],2)+pow(unc_dp[i],2))<<" total unc"<<std::endl; 
    dp_stat->SetBinContent(i+1,(xsec_dp_err[i]/xsec_dp[i])*-1);
    dp_bf->SetBinContent(i+1,fabs(binfit_plus5_dp[i]-xsec_dp[i])/xsec_dp[i]);
    dp_tp->SetBinContent(i+1,0.5*tp_dp[i]);
    dp_acc->SetBinContent(i+1,JAcc);
    dp_cb->SetBinContent(i+1,SigCB);
    dp_bkg->SetBinContent(i+1,Bkg2P);
    dp_fixed->SetBinContent(i+1,PerBinFixed);
  }
  TCanvas* c1 = new TCanvas("c1","c1",600,600);
  dp_stat->SetTitle();
  dp_stat->SetXTitle("|#Delta#phi|");
  dp_stat->SetYTitle("Relative Uncertainty");
  dp_stat->SetFillColor(1);
  dp_stat->SetFillStyle(3006);
  dp_tp->SetFillColor(2);
  dp_tp->SetFillStyle(3004);
  dp_bf->SetFillColor(3);
  dp_bf->SetFillStyle(3005);
  dp_bkg->SetFillColor(5);
  dp_fixed->SetFillColor(4);
  dp_stat->Draw();
  dp_bkg->Draw("same");
  dp_acc->Draw("same");
  dp_cb->Draw("same");
  dp_fixed->Draw("same");
  dp_tp->Draw("same");
  dp_bf->Draw("same");
  auto legend = new TLegend(0.1,0.8,0.4,0.9);
  legend->SetFillStyle(0);
  legend->SetBorderSize(0);
  legend->SetShadowColor(0);
  legend->AddEntry("dp_stat","Statistical #times (-1)","f");
  legend->AddEntry("dp_tp","Tag and Probe","f");
  legend->AddEntry("dp_bf","MC Model Fit","f");
  legend->AddEntry("dp_bkg","MLF shape variation (bkg))","f");
  legend->AddEntry("dp_fixed","1% constant uncertainties)","f");
  legend->Draw();
  for (int i=0; i<7;++i){
    pt1_stat->SetBinContent(i+1,(xsec_pt1_err[i]/xsec_pt1[i])*-1);
    pt1_bf->SetBinContent(i+1,fabs(binfit_plus5_pt1[i]-xsec_pt1[i])/xsec_pt1[i]);
    pt1_tp->SetBinContent(i+1,0.5*tp_pt1[i]);
    pt1_acc->SetBinContent(i+1,JAcc);
    pt1_cb->SetBinContent(i+1,SigCB);
    pt1_bkg->SetBinContent(i+1,Bkg2P);
    pt1_fixed->SetBinContent(i+1,PerBinFixed);
  }
  TCanvas* c2 = new TCanvas("c2","c2",600,600);
  pt1_stat->SetTitle();
  pt1_stat->SetXTitle("Leading J/#psi p_{T} (GeV/c)");
  pt1_stat->SetYTitle("Relative Uncertainty");
  pt1_stat->SetFillColor(1);
  pt1_stat->SetFillStyle(3006);
  pt1_tp->SetFillColor(2);
  pt1_tp->SetFillStyle(3004);
  pt1_bf->SetFillColor(3);
  pt1_bf->SetFillStyle(3005);
  pt1_bkg->SetFillColor(5);
  pt1_fixed->SetFillColor(4);
  pt1_stat->Draw();
  pt1_bkg->Draw("same");
  pt1_acc->Draw("same");
  pt1_cb->Draw("same");
  pt1_fixed->Draw("same");
  pt1_tp->Draw("same");
  pt1_bf->Draw("same");
  auto legend = new TLegend(0.1,0.8,0.4,0.9);
  legend->SetFillStyle(0);
  legend->SetBorderSize(0);
  legend->SetShadowColor(0);
  legend->AddEntry("pt1_stat","Statistical #times (-1)","f");
  legend->AddEntry("pt1_tp","Tag and Probe","f");
  legend->AddEntry("pt1_bf","MC Model Fit","f");
  legend->AddEntry("pt1_bkg","MLF shape variation (bkg))","f");
  legend->AddEntry("pt1_fixed","1% constant uncertainties)","f");
  legend->Draw();
  for (int i=0; i<6;++i){
    pt2_stat->SetBinContent(i+1,(xsec_pt2_err[i]/xsec_pt2[i])*-1);
    pt2_bf->SetBinContent(i+1,fabs(binfit_plus5_pt2[i]-xsec_pt2[i])/xsec_pt2[i]);
    pt2_tp->SetBinContent(i+1,0.5*tp_pt2[i]);
    pt2_acc->SetBinContent(i+1,JAcc);
    pt2_cb->SetBinContent(i+1,SigCB);
    pt2_bkg->SetBinContent(i+1,Bkg2P);
    pt2_fixed->SetBinContent(i+1,PerBinFixed);
  }
  TCanvas* c3 = new TCanvas("c3","c3",600,600);
  pt2_stat->SetTitle();
  pt2_stat->SetXTitle("Subleading J/#psi p_{T} (GeV/c)");
  pt2_stat->SetYTitle("Relative Uncertainty");
  pt2_stat->SetFillColor(1);
  pt2_stat->SetFillStyle(3006);
  pt2_tp->SetFillColor(2);
  pt2_tp->SetFillStyle(3004);
  pt2_bf->SetFillColor(3);
  pt2_bf->SetFillStyle(3005);
  pt2_bkg->SetFillColor(5);
  pt2_fixed->SetFillColor(4);
  pt2_stat->Draw();
  pt2_bkg->Draw("same");
  pt2_acc->Draw("same");
  pt2_cb->Draw("same");
  pt2_fixed->Draw("same");
  pt2_tp->Draw("same");
  pt2_bf->Draw("same");
  auto legend = new TLegend(0.1,0.8,0.4,0.9);
  legend->SetFillStyle(0);
  legend->SetBorderSize(0);
  legend->SetShadowColor(0);
  legend->AddEntry("pt2_stat","Statistical #times (-1)","f");
  legend->AddEntry("pt2_tp","Tag and Probe","f");
  legend->AddEntry("pt2_bf","MC Model Fit","f");
  legend->AddEntry("pt2_bkg","MLF shape variation (bkg))","f");
  legend->AddEntry("pt2_fixed","1% constant uncertainties)","f");
  legend->Draw();
  for (int i=0; i<5;++i){
    pta_stat->SetBinContent(i+1,(xsec_pta_err[i]/xsec_pta[i])*-1);
    pta_bf->SetBinContent(i+1,fabs(binfit_plus5_pta[i]-xsec_pta[i])/xsec_pta[i]);
    pta_tp->SetBinContent(i+1,0.5*tp_pta[i]);
    pta_acc->SetBinContent(i+1,JAcc);
    pta_cb->SetBinContent(i+1,SigCB);
    pta_bkg->SetBinContent(i+1,Bkg2P);
    pta_fixed->SetBinContent(i+1,PerBinFixed);
  }
  TCanvas* c4 = new TCanvas("c4","c4",600,600);
  pta_stat->SetTitle();
  pta_stat->SetXTitle("4-Muon p_{T} Asymmetry (GeV/c)");
  pta_stat->SetYTitle("Relative Uncertainty");
  pta_stat->SetFillColor(1);
  pta_stat->SetFillStyle(3006);
  pta_tp->SetFillColor(2);
  pta_tp->SetFillStyle(3004);
  pta_bf->SetFillColor(3);
  pta_bf->SetFillStyle(3005);
  pta_bkg->SetFillColor(5);
  pta_fixed->SetFillColor(4);
  pta_stat->Draw();
  pta_bkg->Draw("same");
  pta_acc->Draw("same");
  pta_cb->Draw("same");
  pta_fixed->Draw("same");
  pta_tp->Draw("same");
  pta_bf->Draw("same");
  auto legend = new TLegend(0.1,0.8,0.4,0.9);
  legend->SetFillStyle(0);
  legend->SetBorderSize(0);
  legend->SetShadowColor(0);
  legend->AddEntry("pta_stat","Statistical #times (-1)","f");
  legend->AddEntry("pta_tp","Tag and Probe","f");
  legend->AddEntry("pta_bf","MC Model Fit","f");
  legend->AddEntry("pta_bkg","MLF shape variation (bkg))","f");
  legend->AddEntry("pta_fixed","1% constant uncertainties)","f");
  legend->Draw();
}
